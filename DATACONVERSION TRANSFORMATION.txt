----DATACONVERSION TRANSFORMATION----


create table dlithe.dbo.S_HREMPLOYEES_dest
(
  EMPLOYEE_ID FLOAT,
  FIRST_NAME VARCHAR(50),
  LAST_NAME VARCHAR(50),
  EMAIL VARCHAR(50),
  PHONE_NUMBER VARCHAR(50),
  HIRE_DATE DATETIME,
 -- JOB_ID VARCHAR(50),
  SALARY DECIMAL(8,2),
  COMMISSION_PCT DECIMAL(2,2),
  MANAGER_ID FLOAT,
  DEPARTMENT_ID FLOAT
);
SELECT * FROM dlithe.dbo.S_HREMPLOYEES_dest;




CREATE TABLE SRC_EMP1(
ID INT,
FIRST_NAME VARCHAR(50),
LAST_NAME VARCHAR(50),
SAL FLOAT
);

INSERT INTO SRC_EMP1 VALUES(1,'ANI','NALLURI',10000),(2,'RUCHI','SIMHADRY',20000);

SELECT * FROM SRC_EMP1;
SELECT * FROM DEST_EMP2;

CREATE TABLE DEST_EMP2(
ID INT,
FIRST_NAME VARCHAR(50) AS FULL_NAME VARCHAR(50),
SAL FLOAT,
ID INT AS DEP_ID INT,
LAST_NAME VARCHAR(50) AS DEPT_NAME VARCHAR(50)
);

-----ASSIGNMENT------

CREATE TABLE ANI_HEALTH
(
YEAR INT,
STATE VARCHAR(100),
HAI VARCHAR(100),
OPERATIVE_PROCEDURE VARCHAR(50),
FACILITY_1 VARCHAR(20),
FACILITY_NAME VARCHAR(50),
HOSPITAL_CATEGORY VARCHAR(50),
HOSPITAL_TYPE VARCHAR(50),
COUNTRY VARCHAR(50),
PROCEDURE_COUNT INT,
INFECTION_COUNT INT,
PREDICTED_INFECTION_COUNT INT,
SIR INT,
SIR_LOWER INT,
SIR_UPPER INT,
COMPARISION VARCHAR(50),
SIR_20 INT,
ON_TRACK VARCHAR(50),
NOTES VARCHAR(50)
);


INSERT INTO ANI_HEALTH VALUES(2021,'CALIFORNIA','HEALTHCARE ASSOCIATION INFECTION','APPENDIX SURGERY',
'060000','ADVENTIST HEALTH','ACUTE','COMMUNITY','KERN',222,2,4,1,2,3,'SAME',7,'YES','SEE DATA DIC')
INSERT INTO ANI_HEALTH VALUES(2022,'CALIFORNIA','HEALTHCARE ASSOCIATION INFECTION','CARDIAC SURGERY',
'060001','AHMC HEALTH','CRITICAL','COMMUNITY','LAKE',221,1,3,2,6,6,'SAME',8,'YES','SEE DATA DIC')

SELECT * FROM ANI_HEALTH;
SELECT * FROM ANI_HEALTH_dest1;



CREATE TABLE ANI_HEALTH_dest1
(
YEAR INT,
STATE VARCHAR(100),
HAI VARCHAR(100),
OPERATIVE_PROCEDURE VARCHAR(50),
FACILITY_1 VARCHAR(20),
FACILITY_NAME VARCHAR(50),
HOSPITAL_CATEGORY VARCHAR(50),
HOSPITAL_TYPE VARCHAR(50),
COUNTRY VARCHAR(50),
PROCEDURE_COUNT INT,
INFECTION_COUNT INT,
PREDICTED_INFECTION_COUNT INT,
SIR INT,
SIR_LOWER INT,
SIR_UPPER INT,
COMPARISION VARCHAR(50),
SIR_20 INT,
ON_TRACK VARCHAR(50),
NOTES VARCHAR(50)
);
